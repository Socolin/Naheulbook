<div class="effect-panel">
    <md-card class="effect-list-panel">
        <md-card-title>
            Effets
        </md-card-title>
        <md-card-content>
            <div class="effect-list">
                <ng-template ngFor let-characterEffect [ngForOf]="character.computedData.effects" let-i="index" let-last="last">
                    <div (click)="selectEffect(characterEffect)"
                         class="effect-element"
                         [class.selected]="selectedEffect === characterEffect">
                        <span *ngIf="characterEffect.reusable">
                            <md-slide-toggle color="primary"
                                             (change)="updateReusableEffect(characterEffect)"
                                             [ngModel]="characterEffect.active">
                            </md-slide-toggle>
                        </span>
                        <span class="padding">
                            {{characterEffect.effect.name}}
                        </span>
                        <span *ngIf="characterEffect.currentCombatCount !== null">
                            <span class="ra ra-sword duration-icon"></span>{{characterEffect.currentCombatCount}}
                        </span>
                        <span *ngIf="characterEffect.currentTimeDuration">
                            <span class="ra ra-clockwork duration-icon"></span> {{characterEffect.currentTimeDuration | nhbkShortDuration}}
                        </span>
                        <span *ngIf="characterEffect.currentLapCount">
                            <span class="game-icon game-icon-clockwise-rotation duration-icon"></span> {{characterEffect.currentLapCount}}
                        </span>
                    </div>
                </ng-template>
                <ng-template ngFor let-modifier [ngForOf]="character.computedData.modifiers">
                    <div *ngIf="!modifier.permanent"
                         (click)="selectModifier(modifier)"
                             class="effect-element"
                         [class.selected]="selectedModifier === modifier">
                        <div class="modifier-toggle">
                            <md-checkbox color="primary"
                                         [disabled]="!modifier.reusable"
                                         [checked]="modifier.active"
                                         (change)="updateReusableModifier(modifier)">
                            </md-checkbox>
                        </div>
                        <div class="modifier-info">
                            <div>
                                {{modifier.name}}
                            </div>
                            <div class="modifier-type secondary-text">
                                {{modifier.type}}
                            </div>
                        </div>
                        <div class="modifier-duration">
                            <span *ngIf="modifier.combatCount">
                                <span class="ra ra-sword duration-icon"></span>
                                {{modifier.currentCombatCount}}
                            </span>
                            <span *ngIf="modifier.currentTimeDuration">
                                <span class="ra ra-clockwork duration-icon"></span>
                                {{modifier.currentTimeDuration | nhbkShortDuration}}
                            </span>
                            <span *ngIf="modifier.currentLapCount">
                                <span class="game-icon game-icon-clockwise-rotation duration-icon"></span>
                                {{modifier.currentLapCount}}
                            </span>
                        </div>
                    </div>
                </ng-template>
            </div>
        </md-card-content>
        <md-card-actions align="end">
            <button md-button color="primary" (click)="addEffectModal.open()">AJOUTER</button>
        </md-card-actions>
    </md-card>
    <div class="effect-detail-panel">
        <effect-detail *ngIf="selectedEffect" [characterEffect]="selectedEffect" (onRemove)="removeEffect($event)">
        </effect-detail>
        <modifier-detail *ngIf="selectedModifier" [modifier]="selectedModifier" (onRemove)="removeModifier($event)">
        </modifier-detail>
    </div>
</div>


<add-effect-modal #addEffectModal (createModifier)="addCustomModifier($event)">
</add-effect-modal>
