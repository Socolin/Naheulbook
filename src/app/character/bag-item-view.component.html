<template [ngIf]="iconMode">
    <template ngFor let-item [ngForOf]="itemsContained" let-indexItem="index" let-lastItem="last">
        <div class="item-icon" [class.selected]="item === selectedItem" (click)="selectItem(item)">
            <icon [icon]="item.data.icon" [size]="'32px'"></icon>
            <template [ngIf]="item === selectedItem">
                <swipeable-item-detail [gmView]="gmView"
                                       [character]="character"
                                       [item]="item"></swipeable-item-detail>
            </template>
        </div>
    </template>
    <md-divider *ngIf="itemsContained.length"></md-divider>
    <template ngFor let-item [ngForOf]="itemsContainer" let-indexItem="index" let-lastItem="last">
        <div class="item-line"
             (click)="selectItem(item)"
             [class.selected]="selectedItem && selectedItem.id === item.id">
            <icon [icon]="item.data.icon" [size]="'32px'"></icon>
            <span *ngIf="item.data.quantity">{{item.data.quantity}}</span>
            {{item.data.name}}
            <template [ngIf]="item === selectedItem">
                <swipeable-item-detail [gmView]="gmView" [character]="character" [item]="item"></swipeable-item-detail>
            </template>
        </div>
        <div class="item-icon-container">
            <bag-item-view
                [ends]="ends"
                [level]="level + 1"
                [iconMode]="iconMode"
                [end]="lastItem ? 1 : 0"
                [items]="item.content"
                [character]="character"
                [gmView]="gmView"
                [selectedItem]="selectedItem"
                (itemSelected)="selectItem($event)">
            </bag-item-view>
        </div>
    </template>
</template>
<template [ngIf]="!iconMode">
    <template ngFor let-item [ngForOf]="items" let-indexItem="index" let-lastItem="last">
        <div class="item-line">
            <template ngFor let-l [ngForOf]="ends" let-i="index" let-last="last">
                <span>
                    <template [ngIf]="lastItem && last">
                        <img src="/img/tree-top-left.png"/>
                    </template>
                    <template [ngIf]="!lastItem && last">
                        <img src="/img/tree-top-bot-left.png"/>
                    </template>

                    <template [ngIf]="!last">
                        <template [ngIf]="ends[i + 1]">
                            <img src="/img/tree-empty.png"/>
                        </template>
                        <template [ngIf]="!ends[i + 1]">
                            <img src="/img/tree-top-bot.png"/>
                        </template>
                    </template>
                </span>
            </template>
            <div
                class="item-line"
                (click)="selectItem(item)"
                [class.selected]="selectedItem && selectedItem.id === item.id">
                <icon [icon]="item.data.icon" [size]="'32px'"></icon>
                <span *ngIf="item.data.quantity || item.template.data.quantifiable">{{item.data.quantity}}</span>
                {{item.data.name}}
                <template [ngIf]="item === selectedItem">
                    <swipeable-item-detail [gmView]="gmView"
                                           [character]="character"
                                           [item]="item">
                    </swipeable-item-detail>
                </template>
            </div>
        </div>
        <template [ngIf]="item.content">
            <bag-item-view
                [ends]="ends"
                [level]="level + 1"
                [iconMode]="iconMode"
                [end]="lastItem ? 1 : 0"
                [items]="item.content"
                [character]="character"
                [gmView]="gmView"
                [selectedItem]="selectedItem"
                (itemSelected)="selectItem($event)">
            </bag-item-view>
        </template>
    </template>
</template>
