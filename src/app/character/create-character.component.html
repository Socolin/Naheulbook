<md-card>
    <md-toolbar color="primary">
        <span fxFlex="auto">Caractéristiques</span>
        <button *ngIf="(step === 0)"
                fxFlex="nogrow"
                md-mini-fab
                type="button"
                (click)="rollStats()">
            <md-icon fontSet="ra" fontIcon="ra-perspective-dice-random" class="ra-md-button-icon-32"></md-icon>
        </button>
        <button *ngIf="(step >= 1)"
                fxFlex="nogrow"
                md-icon-button
                type="button"
                (click)="setStep(0)">
            <md-icon>edit</md-icon>
        </button>
    </md-toolbar>
    <md-card-content>
        <p *ngIf="step == 0">
            Lancez cinq fois un D6 pour obtenir les caractéristiques principales. Ces jets cruciaux vont définir tout
            le profil du personnage. Vous ajoutez 7 à chaque score pour obtenir les caractéristiques suivantes (ce qui
            donnera une note de 8 à 13) :
        </p>
        <div fxLayout="row" fxLayoutAlign="space-around center">
            <md-input-container fxFlex="auto">
                <input mdInput
                       type="number"
                       [(ngModel)]="cou"
                       [disabled]="step > 0"
                       placeholder="Courage"
                       min=0 />
            </md-input-container>
            <md-input-container fxFlex="auto">
                <input mdInput
                       type="number"
                       [(ngModel)]="int"
                       [disabled]="step > 0"
                       placeholder="Inteligence"
                       min=0 />
            </md-input-container>
            <md-input-container fxFlex="auto">
                <input mdInput
                       type="number"
                       [(ngModel)]="cha"
                       [disabled]="step > 0"
                       placeholder="Charisme"
                       min=0 />
            </md-input-container>
            <md-input-container fxFlex="auto">
                <input mdInput
                       type="number"
                       [(ngModel)]="ad"
                       [disabled]="step > 0"
                       placeholder="Adresse"
                       min=0 />
            </md-input-container>
            <md-input-container fxFlex="auto">
                <input mdInput
                       type="number"
                       [(ngModel)]="fo"
                       [disabled]="step > 0"
                       placeholder="Force"
                       min=0 />
            </md-input-container>
        </div>
    </md-card-content>
    <md-card-actions *ngIf="step == 0" align="end">
        <button md-button type="button" color="primary" (click)="setStep(1)" [disabled]="!cou || !cha || !int || !fo || !ad">
            VALIDER
        </button>
    </md-card-actions>
</md-card>

<md-card *ngIf="(step >= 1)">
    <md-toolbar color="primary">
        <span fxFlex="auto">Origine</span>
        <button *ngIf="(step === 1)"
                fxFlex="nogrow"
                md-icon-button
                type="button"
                (click)="toggleViewAllOrigins()">
            <md-icon>filter_list</md-icon>
        </button>
        <button *ngIf="(step === 1)"
                fxFlex="nogrow"
                md-mini-fab
                type="button"
                (click)="selectRandomOrigin()">
            <md-icon fontSet="ra" fontIcon="ra-perspective-dice-random" class="ra-md-button-icon-32"></md-icon>
        </button>
        <button *ngIf="(step > 1)"
                fxFlex="nogrow"
                md-icon-button
                type="button"
                (click)="setStep(1)">
            <md-icon>edit</md-icon>
        </button>
    </md-toolbar>
    <md-card-content>
        <div *ngIf="(step == 1)">
            <origin-selector [selectedOrigin]="selectedOrigin"
                             (originChange)="onSelectOrigin($event)"
                             [cou]="cou"
                             [int]="int"
                             [cha]="cha"
                             [ad]="ad"
                             [fo]="fo">
            </origin-selector>
        </div>
        <div *ngIf="(step > 1)">
            {{selectedOrigin.name}}
        </div>
    </md-card-content>
</md-card>


<md-card *ngIf="(step >= 2)">
    <md-toolbar color="primary">
        <span fxFlex="auto">Métier</span>
        <button *ngIf="(step === 2)"
                fxFlex="nogrow"
                md-icon-button
                type="button"
                (click)="toggleViewAllJobs()">
            <md-icon>filter_list</md-icon>
        </button>
        <button *ngIf="(step === 2)"
                fxFlex="nogrow"
                md-mini-fab
                type="button"
                (click)="selectRandomJob()">
            <md-icon fontSet="ra" fontIcon="ra-perspective-dice-random" class="ra-md-button-icon-32"></md-icon>
        </button>
        <button *ngIf="(step > 2)"
                fxFlex="nogrow"
                md-icon-button
                type="button"
                (click)="setStep(2)">
            <md-icon>edit</md-icon>
        </button>
    </md-toolbar>
    <md-card-content>
        <div *ngIf="(step == 2)">
            <job-selector [selectedOrigin]="selectedOrigin"
                          (jobChange)="onSelectJob($event)"
                          [cou]="cou"
                          [int]="int"
                          [cha]="cha"
                          [ad]="ad"
                          [fo]="fo">
            </job-selector>
        </div>
        <div *ngIf="(step > 2)">
            <span *ngIf="selectedJob">
                {{selectedJob.name}}
            </span>
            <span *ngIf="!selectedJob">
                Aucun
            </span>
        </div>
    </md-card-content>
</md-card>

<md-card *ngIf="(step >= 3)">
    <md-toolbar color="primary">
        <span fxFlex="auto">Compétences</span>
        <button *ngIf="(step === 3)"
                fxFlex="nogrow"
                md-mini-fab
                type="button"
                (click)="selectRandomSkills()">
            <md-icon fontSet="ra" fontIcon="ra-perspective-dice-random" class="ra-md-button-icon-32"></md-icon>
        </button>
        <button *ngIf="(step > 3)"
                fxFlex="nogrow"
                md-icon-button
                type="button"
                (click)="setStep(3)">
            <md-icon>edit</md-icon>
        </button>
    </md-toolbar>
    <md-card-content>
        <div *ngIf="(step == 3)">
            <skill-selector [selectedOrigin]="selectedOrigin"
                            [selectedJob]="selectedJob"
                            (skillsSelected)="onSelectSkills($event)">
            </skill-selector>
        </div>
        <div *ngIf="(step > 3)">
            <div *ngFor="let skill of selectedSkills">
                {{skill.name}}
            </div>
        </div>
    </md-card-content>
</md-card>

<md-card *ngIf="(step >= 4)">
    <md-toolbar color="primary">
        <span fxFlex="auto">Fortune de départ</span>
        <button *ngIf="(step === 4)"
                fxFlex="nogrow"
                md-mini-fab
                type="button"
                (click)="rollMoney()">
            <md-icon fontSet="ra" fontIcon="ra-perspective-dice-random" class="ra-md-button-icon-32"></md-icon>
        </button>
        <button *ngIf="(step > 4)"
                fxFlex="nogrow"
                md-icon-button
                type="button"
                (click)="setStep(4)">
            <md-icon>edit</md-icon>
        </button>
    </md-toolbar>
    <md-card-content>
        <p *ngIf="step == 4">
            Tirer le pécule de départ permet de connaître la classe sociale du personnage. Le jet de dés est le suivant :<br/>
            ➢ 2D6 x 10 = pécule de pièces d’or au départ de l’aventure
        </p>
        <p *ngIf="step == 4 && has2MoneyRoll()">
            Votre metier vous donne droit a un deuxieme jet de votre fortune initiale qui s'additionne avec le premier.
        </p>
        <div fxLayout="row" fxLayoutAlign="space-around center">
            <md-input-container fxFlex="auto">
                <input mdInput
                       type="number"
                       [(ngModel)]="money"
                       [disabled]="step > 4"
                       placeholder="Fortune"
                       min=0 />
            </md-input-container>

            <md-input-container fxFlex="auto" *ngIf="has2MoneyRoll()">
                <input mdInput
                       type="number"
                       [(ngModel)]="money2"
                       [disabled]="step > 4"
                       placeholder="Fortune jet 2"
                       min=0 />
            </md-input-container>
        </div>
        <div>
            Fortune: {{(money + money2) * 10}} PO
        </div>
    </md-card-content>
    <md-card-actions *ngIf="step == 4" align="end">
        <button md-button type="button" color="primary" (click)="setStep(5)" [disabled]="!money || (!money2 && has2MoneyRoll())">
            VALIDER
        </button>
    </md-card-actions>
</md-card>


<md-card *ngIf="(step >= 5) && hasStatModification()">
    <md-toolbar color="primary">
        <span fxFlex="auto">Trucs spéciaux</span>
        <button *ngIf="(step > 5)"
                fxFlex="nogrow"
                md-icon-button
                type="button"
                (click)="setStep(5)">
            <md-icon>edit</md-icon>
        </button>
    </md-toolbar>
    <md-card-content>
        <div *ngIf="hasSuperBourin()">
            <h3>SUPER-BOURRIN</h3>
            <p *ngIf="step == 5">
                a le droit de retrancher jusqu'à 3 points à son score de base en ATTAQUE et/ou en PARADE
                pour en faire un bonus de dégâts (au corps à corps, toutes armes confondues). Ainsi il peut avoir +3 en dégâts en plus de ses
                autres bonus de FORCE, mais son côté bourrin le rend maladroit. Le bonus est à choisir en début de carrière et ne pourra
                être modifié par la suite.
            </p>

            <div *ngIf="step == 5">
                AT:
                <md-button-toggle-group [(ngModel)]="superBourrinValueAt" (change)="updateSuperBourrin()">
                    <md-button-toggle [value]="0">0</md-button-toggle>
                    <md-button-toggle [disabled]="superBourrinValuePrd > 2"  [value]="1">-1</md-button-toggle>
                    <md-button-toggle [disabled]="superBourrinValuePrd > 1"  [value]="2">-2</md-button-toggle>
                    <md-button-toggle [disabled]="superBourrinValuePrd > 0"  [value]="3">-3</md-button-toggle>
                </md-button-toggle-group>
                PRD:
                <md-button-toggle-group [(ngModel)]="superBourrinValuePrd" (change)="updateSuperBourrin()">
                    <md-button-toggle [value]="0">0</md-button-toggle>
                    <md-button-toggle [disabled]="superBourrinValueAt > 2" [value]="1">-1</md-button-toggle>
                    <md-button-toggle [disabled]="superBourrinValueAt > 1" [value]="2">-2</md-button-toggle>
                    <md-button-toggle [disabled]="superBourrinValueAt > 0" [value]="3">-3</md-button-toggle>
                </md-button-toggle-group>
            </div>

            <p *ngIf="superBourrinValueAt && superBourrinValuePrd">
                Retrancher <em>{{superBourrinValueAt}}</em> point(s) du score de base <em>d'attaque</em>
                et <em>{{superBourrinValuePrd}}</em> point(s) du score de base de <em>parade</em>
                et ajouter <em>{{superBourrinValueAt + superBourrinValuePrd}}</em> point(s) de dégâts.
            </p>
            <p *ngIf="!superBourrinValueAt && superBourrinValuePrd">
                Retrancher <em>{{superBourrinValuePrd}}</em> point(s) du score de base de <em>parade</em>
                et ajouter <em>{{superBourrinValueAt + superBourrinValuePrd}}</em> point(s) de dégâts.
            </p>
            <p *ngIf="superBourrinValueAt && !superBourrinValuePrd">
                Retrancher <em>{{superBourrinValueAt}}</em> point(s) du score de base <em>d'attaque</em>
                et ajouter <em>{{superBourrinValueAt + superBourrinValuePrd}}</em> point(s) de dégâts.
            </p>
            <p *ngIf="!superBourrinValueAt && !superBourrinValuePrd">
                Ne rien changer.
            </p>
        </div>

        <div *ngIf="hasMove1PointStat()">
            <h3>Deplacement d'un point de stat</h3>
            <p>
                En raison de sa polyvalence, au niveau 1 le Ranger peut choisir de soustraire 1 point d'une CARAC pour l'ajouter à une
                autre (INT, CHA, COU, FO, AD)
            </p>

            <div fxLayout="row" fxLayoutAlign="space-around center">
                <button md-icon-button (click)="move1PointStat('cou', 1)">
                    <md-icon [color]="move1PointStatValues['cou'] == 1 ? 'accent' : null">keyboard_arrow_up</md-icon>
                </button>
                <button md-icon-button (click)="move1PointStat('int', 1)">
                    <md-icon [color]="move1PointStatValues['int'] == 1 ? 'accent' : null">keyboard_arrow_up</md-icon>
                </button>
                <button md-icon-button (click)="move1PointStat('cha', 1)">
                    <md-icon [color]="move1PointStatValues['cha'] == 1 ? 'accent' : null">keyboard_arrow_up</md-icon>
                </button>
                <button md-icon-button (click)="move1PointStat('ad', 1)">
                    <md-icon [color]="move1PointStatValues['ad'] == 1 ? 'accent' : null">keyboard_arrow_up</md-icon>
                </button>
                <button md-icon-button (click)="move1PointStat('fo', 1)">
                    <md-icon [color]="move1PointStatValues['fo'] == 1 ? 'accent' : null">keyboard_arrow_up</md-icon>
                </button>
            </div>
            <div fxLayout="row" fxLayoutAlign="space-around center">
                <md-input-container fxFlex="auto">
                    <input mdInput [ngModel]="cou + move1PointStatValues['cou']" disabled placeholder="Courage"/>
                </md-input-container>
                <md-input-container fxFlex="auto">
                    <input mdInput [ngModel]="int + move1PointStatValues['int']" disabled placeholder="Inteligence" />
                </md-input-container>
                <md-input-container fxFlex="auto">
                    <input mdInput [ngModel]="cha + move1PointStatValues['cha']" disabled placeholder="Charisme" />
                </md-input-container>
                <md-input-container fxFlex="auto">
                    <input mdInput [ngModel]="ad + move1PointStatValues['ad']" disabled placeholder="Adresse" />
                </md-input-container>
                <md-input-container fxFlex="auto">
                    <input mdInput [ngModel]="fo + move1PointStatValues['fo']" disabled placeholder="Force" />
                </md-input-container>
            </div>
            <div fxLayout="row" fxLayoutAlign="space-around center">
                <button md-icon-button (click)="move1PointStat('cou', -1)">
                    <md-icon [color]="move1PointStatValues['cou'] == -1 ? 'accent' : null">keyboard_arrow_down</md-icon>
                </button>
                <button md-icon-button (click)="move1PointStat('int', -1)">
                    <md-icon [color]="move1PointStatValues['int'] == -1 ? 'accent' : null">keyboard_arrow_down</md-icon>
                </button>
                <button md-icon-button (click)="move1PointStat('cha', -1)">
                    <md-icon [color]="move1PointStatValues['cha'] == -1 ? 'accent' : null">keyboard_arrow_down</md-icon>
                </button>
                <button md-icon-button (click)="move1PointStat('ad', -1)">
                    <md-icon [color]="move1PointStatValues['ad'] == -1 ? 'accent' : null">keyboard_arrow_down</md-icon>
                </button>
                <button md-icon-button (click)="move1PointStat('fo', -1)">
                    <md-icon [color]="move1PointStatValues['fo'] == -1 ? 'accent' : null">keyboard_arrow_down</md-icon>
                </button>
            </div>
        </div>
        <div *ngIf="hasChangeAtPrd()">
            <h3>Deplacement d'un point de d'attaque et de parade</h3>
            <p *ngIf="step == 5">
                Peut choisir au niveau 1 d'échanger 1 point d'ATTAQUE avec 1 point de PARADE, ou inversement
            </p>

            <md-button-toggle-group *ngIf="step == 5" [(ngModel)]="changeAtPrdValue">
                <md-button-toggle [value]="1">+1 AT -1 PRD</md-button-toggle>
                <md-button-toggle [value]="0">Aucune modification</md-button-toggle>
                <md-button-toggle [value]="-1">-1 AT +1 PRD</md-button-toggle>
            </md-button-toggle-group>

            <div *ngIf="step > 5">
                <span *ngIf="changeAtPrdValue === 1">Ajouter un point d'attaque et retrancher un point de parade</span>
                <span *ngIf="changeAtPrdValue === 0">Aucune modification</span>
                <span *ngIf="changeAtPrdValue === -1">Ajouter un point de parade et retrancher un point d'attaque</span>
            </div>
        </div>
        <div *ngIf="hasRemoveAttOrPrdToIntOrCha()">
            <h3>Marchand</h3>
            <p>
                En raison de son érudition, au niveau 1 le marchand doit retirer 1 point à l'attaque ou à la parade,
                qu'il pourra ajouter au choix à l'intelligence ou au charisme
            </p>

            <span *ngIf="step == 5">
                Enlever un point
                <md-button-toggle-group [(ngModel)]="removeAttOrPrdToIntOrChaRemoveStat" (change)="updateRemoveAttOrPrdToIntOrCha()">
                    <md-button-toggle value="AT">d'attaque</md-button-toggle>
                    <md-button-toggle value="PRD">de parade</md-button-toggle>
                </md-button-toggle-group>

                et l'ajouter en
                <md-button-toggle-group [(ngModel)]="removeAttOrPrdToIntOrChaAddStat" (change)="updateRemoveAttOrPrdToIntOrCha()">
                    <md-button-toggle value="INT">intelligence</md-button-toggle>
                    <md-button-toggle value="CHA">charisme</md-button-toggle>
                </md-button-toggle-group>
            </span>
            <span *ngIf="step > 5">
                Enlever un point <em>{{removeAttOrPrdToIntOrChaRemoveStat == 'AT' ? "d'attaque" : "de parade"}}</em>
                et l'ajouter en <em>{{removeAttOrPrdToIntOrChaAddStat == 'INT' ? 'inteligence' : 'charisme'}}</em>.
            </span>
        </div>

        <div *ngIf="hasRemoveAttOrPrdToIntOrAd()">
            <h3>Ingenieur</h3>
            <p>
                En raison de sa spécialisation technique, au niveau 1 l'ingénieur doit retirer 1 point à l'attaque ou à la parade, qu'il pourra
                ajouter au choix à l'intelligence ou à l'adresse
            </p>

            <span *ngIf="step == 5">
                Enlever un point
                <md-button-toggle-group [(ngModel)]="removeAttOrPrdToIntOrAdRemoveStat" (change)="updateRemoveAttOrPrdToIntOrAd()">
                    <md-button-toggle value="AT">d'attaque</md-button-toggle>
                    <md-button-toggle value="PRD">de parade</md-button-toggle>
                </md-button-toggle-group>

                et l'ajouter en
                <md-button-toggle-group [(ngModel)]="removeAttOrPrdToIntOrAdAddStat" (change)="updateRemoveAttOrPrdToIntOrAd()">
                    <md-button-toggle value="INT">intelligence</md-button-toggle>
                    <md-button-toggle value="AD">adresse</md-button-toggle>
                </md-button-toggle-group>
            </span>
            <span *ngIf="step > 5">
                Enlever un point <em>{{removeAttOrPrdToIntOrAdRemoveStat == 'AT' ? "d'attaque" : "de parade"}}</em>
                et l'ajouter en <em>{{removeAttOrPrdToIntOrAdAddStat == 'INT' ? 'inteligence' : 'adresse'}}</em>.
            </span>
        </div>

    </md-card-content>
    <md-card-actions *ngIf="step == 5" align="end">
        <button md-button type="button" (click)="setStep(6)" color="primary" [disabled]="!isStatModificationValid()">
            VALIDER
        </button>
    </md-card-actions>
</md-card>

<md-card *ngIf="(step >= 6) && hasSpeciality()">
    <md-toolbar color="primary">
        <span fxFlex="auto">Specialité</span>
        <button *ngIf="(step === 6)"
                fxFlex="nogrow"
                md-mini-fab
                type="button"
                (click)="randomSpeciality()">
            <md-icon fontSet="ra" fontIcon="ra-perspective-dice-random" class="ra-md-button-icon-32"></md-icon>
        </button>
        <button *ngIf="(step > 6)"
                fxFlex="nogrow"
                md-icon-button
                type="button"
                (click)="setStep(6)">
            <md-icon>edit</md-icon>
        </button>
    </md-toolbar>
    <md-card-content>
        <div *ngIf="step == 6">
            <ng-template ngFor let-speciality [ngForOf]="selectedJob.specialities">
                <md-card class="speciality">
                    <md-card-title>
                        {{speciality.name}}
                    </md-card-title>
                    <md-card-content>
                        <p>{{speciality.description}}</p>
                    </md-card-content>
                    <md-card-actions align="end">
                        <button md-button color="primary" (click)="selectSpeciality(speciality)">
                            SELECTIONNER
                        </button>
                    </md-card-actions>
                </md-card>
            </ng-template>
        </div>
        <div *ngIf="(step > 6 && selectedSpeciality != null)" class="row">
            {{selectedSpeciality.name}}
        </div>
    </md-card-content>
</md-card>


<md-card *ngIf="(step >= 7)">
    <md-toolbar color="primary">
        <span fxFlex="auto">Nom &amp; sexe</span>
        <button *ngIf="(step === 7)"
                fxFlex="nogrow"
                md-mini-fab
                type="button"
                (click)="randomNameAndSex()">
            <md-icon fontSet="ra" fontIcon="ra-perspective-dice-random" class="ra-md-button-icon-32"></md-icon>
        </button>
        <button *ngIf="(step > 7)"
                fxFlex="nogrow"
                md-icon-button
                type="button"
                (click)="setStep(7)">
            <md-icon>edit</md-icon>
        </button>
    </md-toolbar>
    <md-card-content>
        <div>
            <md-radio-group name="sexe" [(ngModel)]="sex" [disabled]="step > 7">
                <md-radio-button name="sexe" [value]="'Homme'">
                    Homme
                </md-radio-button>
                <md-radio-button name="sexe" [value]="'Femme'">
                    Femme
                </md-radio-button>
            </md-radio-group>
        </div>
        <div fxLayout="row">
            <md-input-container fxFlex="auto">
                <input mdInput
                       type="text"
                       [(ngModel)]="name"
                       [disabled]="step > 7"
                       placeholder="Nom"
                       required/>
            </md-input-container>
            <button *ngIf="(step === 7)"
                    fxFlex="nogrow"
                    md-icon-button
                    type="button"
                    (click)="randomName()">
                <md-icon fontSet="ra" fontIcon="ra-perspective-dice-random" class="ra-md-button-icon-32"></md-icon>
            </button>
        </div>
    </md-card-content>
    <md-card-actions *ngIf="step == 7" align="end">
        <button md-button type="button" (click)="validName()" color="primary" [disabled]="!name || !sex">
            VALIDER
        </button>
    </md-card-actions>
</md-card>



<md-card *ngIf="(step >= 8)">
    <md-toolbar color="primary">
        <span fxFlex="auto">Points de destin</span>
        <button *ngIf="(step === 8)"
                fxFlex="nogrow"
                md-mini-fab
                type="button"
                (click)="rollFatePoint()">
            <md-icon fontSet="ra" fontIcon="ra-perspective-dice-random" class="ra-md-button-icon-32"></md-icon>
        </button>
        <button *ngIf="(step > 8)"
                fxFlex="nogrow"
                md-icon-button
                type="button"
                (click)="setStep(8)">
            <md-icon>edit</md-icon>
        </button>
    </md-toolbar>
    <md-card-content>
        <div *ngIf="step == 8">
            Tirez 1D4-1 pour determiner votre nombre de point de destins.
            Cela donne un score de 0 à 3... Oui, les guignards n'ont pas de point de destin.
        </div>
        <div fxLayout="row" fxLayoutAlign="space-around center">
            <md-input-container fxFlex="auto">
                <input mdInput
                       type="number"
                       [(ngModel)]="fatePoint"
                       [disabled]="step > 8"
                       placeholder="Point de destins"
                       min=0 />
            </md-input-container>
        </div>
    </md-card-content>
    <md-card-actions *ngIf="step == 8" align="end">
        <button md-button type="button" (click)="validFatePoint()" color="primary" [disabled]="!fatePoint">
            VALIDER
        </button>
    </md-card-actions>
</md-card>

<div *ngIf="(step == 9)" fxLayout="row">
    <button fxFlex="auto"
            md-raised-button
            [disabled]="creating"
            (click)="createCharacter()">
        Creer
    </button>
</div>
