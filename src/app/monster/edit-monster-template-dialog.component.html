<mat-toolbar color="primary">
    <button mat-icon-button mat-dialog-close>
        <mat-icon>close</mat-icon>
    </button>
    <span>
        Créer un modèle de monstre
    </span>
    <button mat-button>
        AJOUTER
    </button>
</mat-toolbar>

<div class="content mat-typography">
    <div class="category-selection">
        <mat-form-field class="type-selector">
            <mat-select [ngModel]="selectedType" (selectionChange)="selectType($event.value);" placeholder="Catégorie">
                <mat-option *ngFor="let type of monsterTemplateTypes" [value]="type">{{type.name}}</mat-option>
                <mat-option [value]="'new'">
                <span class="secondary-text">
                    Ajouter...
                </span>
                </mat-option>
            </mat-select>
        </mat-form-field>
        <mat-form-field *ngIf="selectedType" class="category-selector">
            <mat-select [ngModel]="selectedCategory" (selectionChange)="selectCategory($event.value)"
                        placeholder="Sous-catégorie">
                <mat-option *ngFor="let category of selectedType.categories" [value]="category">
                    {{category.name}}
                </mat-option>
                <mat-option [value]="'new'">
                <span class="secondary-text">
                    Ajouter...
                </span>
                </mat-option>
            </mat-select>
        </mat-form-field>
    </div>

    <h2>Informations générales</h2>

    <form [formGroup]="form">
        <div class="name">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       placeholder="Nom"
                       formControlName="name"
                />
            </mat-form-field>
        </div>

        <div class="at">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       type="number"
                       placeholder="Attaque"
                       formControlName="at"
                />
            </mat-form-field>
        </div>
        <div class="prd">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       type="number"
                       placeholder="Parade"
                       formControlName="prd"
                />
            </mat-form-field>
        </div>
        <div class="esq">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       type="number"
                       placeholder="Esquive"
                       formControlName="esq"
                />
            </mat-form-field>
        </div>
        <div class="ev">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       type="number"
                       placeholder="E.Vitale"
                       formControlName="ev"
                />
            </mat-form-field>
        </div>
        <div class="ea">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       type="number"
                       placeholder="E.Astrale"
                       formControlName="ea"
                />
            </mat-form-field>
        </div>
        <div class="xp">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       type="number"
                       placeholder="Experience"
                       formControlName="xp"
                />
            </mat-form-field>
        </div>
        <div class="pr">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       type="number"
                       placeholder="Protection"
                       formControlName="pr"
                />
            </mat-form-field>
        </div>
        <div class="pr_magic">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       type="number"
                       placeholder="Protec.Magique"
                       formControlName="pr_magic"
                />
            </mat-form-field>
        </div>
        <div class="resm">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       type="number"
                       placeholder="Resist.Magique"
                       formControlName="resm"
                />
            </mat-form-field>
        </div>
        <div class="dmg">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       placeholder="Dégats"
                       formControlName="dmg"
                />
            </mat-form-field>
        </div>
        <div class="cou">
            <mat-form-field>
                <input matInput
                       autocomplete="off"
                       autocapitalize="off"
                       type="number"
                       placeholder="Courage"
                       formControlName="cou"
                />
            </mat-form-field>
        </div>
        <div class="chercheNoise">
            <mat-checkbox formControlName="chercheNoise">
                Chercher des noises
            </mat-checkbox>
        </div>
         <div class="note">
            <mat-form-field>
                        <textarea matInput placeholder="Note"
                                  formControlName="note"
                                  cdkTextareaAutosize
                                  cdkAutosizeMinRows="1"
                                  cdkAutosizeMaxRows="5">
                        </textarea>
            </mat-form-field>
        </div>
    </form>

    <h2>Traits</h2>
    <div class="traits">
        <button mat-raised-button>
            <mat-icon>add</mat-icon>
            Ajouter
        </button>
    </div>
    <h2>Localisations</h2>
    <div class="locations">
        <button mat-raised-button>
            <mat-icon>add</mat-icon>
            Ajouter
        </button>
    </div>
    <h2>Inventaire</h2>
    <div class="inventory">
        <div *ngFor="let inventoryElement of monsterInventory" class="inventory-element">
            <icon [icon]="inventoryElement.itemTemplate.data.icon"></icon>
            <span>
                <span *ngIf="inventoryElement.minCount === inventoryElement.maxCount && inventoryElement.minCount !== 1">{{inventoryElement.minCount}}</span>
                <span *ngIf="inventoryElement.minCount !== inventoryElement.maxCount">{{inventoryElement.minCount}}-{{inventoryElement.maxCount}}</span>
                {{inventoryElement.itemTemplate.name}}
            </span>
            <span>{{inventoryElement.chance * 100 | number:'1.0-2'}}%</span>
            <span>
                 <button mat-icon-button [matMenuTriggerFor]="inventoryElementMenu">
                    <mat-icon>more_vert</mat-icon>
                </button>
                <mat-menu #inventoryElementMenu="matMenu">
                    <button mat-menu-item (click)="openEditInventoryElementDialog(inventoryElement)">
                        <mat-icon>edit</mat-icon> Modifier
                    </button>
                    <button mat-menu-item (click)="removeInventoryElement(inventoryElement)">
                        <mat-icon>delete</mat-icon> Supprimer
                    </button>
                </mat-menu>
            </span>
        </div>
        <button mat-raised-button (click)="openAddItemToInventoryDialog()">
            <mat-icon>add</mat-icon>
            Ajouter
        </button>
    </div>

    <!--
    <div class="traits">

        <div>
            <div>Traits simple</div>
            <div>
                <ng-template ngFor let-trait [ngForOf]=simpleTraits>
                    <button *ngIf="hasTrait(trait)"
                            mat-raised-button
                            type="button"
                            class="btn btn-default"
                            color="primary"
                            (click)="toggleTrait(trait)">
                        {{trait.name}}
                    </button>
                    <button *ngIf="!hasTrait(trait)"
                            mat-button
                            type="button"
                            class="btn btn-default"
                            color="primary"
                            (click)="toggleTrait(trait)">
                        {{trait.name}}
                    </button>
                </ng-template>
            </div>
        </div>
        <div>
            <div>Traits</div>
            <div>
                <div class="btn-group" role="group">
                    <ng-template ngFor let-trait [ngForOf]=powerTraits>
                        <button *ngIf="!hasTrait(trait)"
                                mat-button
                                type="button"
                                class="btn btn-default"
                                color="primary"
                                (click)="toggleTrait(trait)">
                            {{trait.name}}
                        </button>
                        <button *ngIf="hasTrait(trait)"
                                mat-raised-button
                                type="button"
                                class="btn btn-default"
                                [color]="hasTraitLevel(trait, 1) ? 'primary' : (hasTraitLevel(trait, 2) ? 'accent' : 'warn')"
                                (click)="toggleTrait(trait)">
                            {{trait.name}}
                        </button>
                    </ng-template>
                </div>
            </div>
        </div>
        <div>
            <div *ngIf="locationsById">
            <span style="border-radius: 4px; background-color: #7aa09b; margin-right: 5px"
                  *ngFor="let locationId of monster.locations">
                {{locationsById[locationId].name}} <span (click)="removeLocation(locationId)">X</span>
            </span>
                <autocomplete-input [placeholder]="'Lieu'"
                                    [value]="locationSearchName" (onSelect)="selectLocation($event)"
                                    [(callback)]="autocompleteLocationsCallback"></autocomplete-input>

            </div>
        </div>
        <div>
            <autocomplete-search-item-template [clearOnSelect]="true"
                                               [placeholder]="'Ajouter un objet dans l\'inventaire'"
                                               (onSelect)="addItemSimpleInventory($event)">
            </autocomplete-search-item-template>
        </div>
        <mat-card *ngIf="monster.simpleInventory && monster.simpleInventory.length">
            <mat-card-subtitle>Inventaire</mat-card-subtitle>
            <ng-template ngFor let-inventory [ngForOf]="monster.simpleInventory" let-i="index">
                <div>
                    <button mat-icon-button (click)="removeItemSimpleInventory(i)">
                        <mat-icon>delete</mat-icon>
                    </button>
                    {{inventory.itemTemplate.name}}
                </div>
                <div>
                    <mat-form-field>
                        <input matInput type="number" min=0 [(ngModel)]="inventory.minCount" placeholder="Quantité min" />
                    </mat-form-field>
                    <mat-form-field>
                        <input matInput type="number" min=0 [(ngModel)]="inventory.maxCount" placeholder="Quantité max" />
                    </mat-form-field>
                    <mat-form-field>
                        <input matInput type="number" min=0 step="0.0001" [(ngModel)]="inventory.chance" placeholder="Chance" />
                    </mat-form-field>
                    <mat-checkbox [(ngModel)]="inventory.equiped">Equipé</mat-checkbox>
                    <mat-checkbox [(ngModel)]="inventory.hidden">Caché</mat-checkbox>
                </div>
            </ng-template>
        </mat-card>
    </div>-->
</div>
