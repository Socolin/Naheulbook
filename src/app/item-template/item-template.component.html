<mat-card>
    <mat-card-subtitle *ngIf="itemTemplate.source === 'community'" style="display: flex; align-items: center">
        <mat-icon>group</mat-icon>Object communautaire<span *ngIf="itemTemplate.sourceUser">&nbsp;créé par {{itemTemplate.sourceUser}}</span>
    </mat-card-subtitle>
    <mat-card-subtitle *ngIf="itemTemplate.source === 'private'" style="display: flex; align-items: center">
        <mat-icon>lock</mat-icon> Object privé
    </mat-card-subtitle>
    <mat-card-header>
        <icon matCardAvatar [enchanted]="itemTemplate.data.enchantment !== undefined" [icon]="itemTemplate.data.icon" [size]="'40px'"></icon>
        <mat-card-title>
            {{itemTemplate.name}}
            <span *ngIf="itemTemplate.data.enchantment !== undefined">(Ench. {{itemTemplate.data.enchantment}})</span>
        </mat-card-title>
        <mat-card-subtitle>
            <span *ngIf="itemTemplate.data.enchantment !== undefined">Enchanté </span>
            <span *ngIf="itemTemplate.data.requireLevel">Niveau {{itemTemplate.data.requireLevel}} </span>
            <span *ngIf="itemTemplate.data.relic">Relique </span>
            <span *ngIf="itemTemplate.data.sex == 'h'">Homme uniq. </span>
            <span *ngIf="itemTemplate.data.sex == 'f'">Femme uniq. </span>
        </mat-card-subtitle>
        <span class="padding"></span>
        <button mat-icon-button
                [matMenuTriggerFor]="itemTemplateMenu"
                *ngIf="copyable || editable || hasAction('addItem')">
            <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #itemTemplateMenu>
            <button mat-menu-item  *ngIf="copyable" (click)="openCreateItemTemplateDialog(itemTemplate)">
                <mat-icon>content_copy</mat-icon>
                Créer une copie
            </button>
            <button mat-menu-item  *ngIf="editable" (click)="openEditItemTemplateDialog(itemTemplate)">
                <mat-icon>edit</mat-icon>
                Éditer
            </button>
            <button mat-menu-item
                    *ngIf="hasAction('addItem')"
                    (click)="emitAction('addItem', itemTemplate)">
                <mat-icon>add</mat-icon>
                Ajouter sur...
            </button>
        </mat-menu>
    </mat-card-header>

    <!-- Dice drop -->
    <div class="icon-label" *ngIf="itemTemplate.data.diceDrop">
        <mat-icon fontSet="ra" fontIcon="ra-perspective-dice-random" class="ra-mat-button-icon-24"></mat-icon>
        <div>
            {{itemTemplate.data.diceDrop}}
        </div>
    </div>

    <!-- Throwable -->
    <div *ngIf="itemTemplate.data.throwable">
        <span>Arme prévue pour le jet</span>
    </div>

    <!-- Slots -->
    <div *ngIf="itemTemplate.slots?.length > 0">
        <span>
            Slot:
        </span>
        <ng-template ngFor let-slot [ngForOf]="itemTemplate.slots">
            <span>{{slot.name}} </span>
        </ng-template>
    </div>

    <!-- Description -->
    <div *ngIf="itemTemplate.data.description">
        <span>Description:</span>
        {{itemTemplate.data.description}}
    </div>

    <!-- Note -->
    <div *ngIf="itemTemplate.data.note">
        <span>Note:</span>
        {{itemTemplate.data.note}}
    </div>

    <!-- Encombrement -->
    <div *ngIf="itemTemplate.data.space">
        <span>
            Encombrement:
        </span>
        {{itemTemplate.data.space}}
    </div>

    <!-- Possibilités de récolte -->
    <div *ngIf="itemTemplate.data.availableLocation">
        <span>
            Possibilités de récolte:
        </span>
        {{itemTemplate.data.availableLocation}}
    </div>

    <!-- Dieu -->
    <div class="icon-label" *ngIf="itemTemplate.data.god && godsByTechName">
        <mat-icon fontSet="game-icon" fontIcon="game-icon-prayer" class="ra-mat-button-icon-24"></mat-icon>
        <div>
            <span>Dieu:</span>
            {{godsByTechName[itemTemplate.data.god].displayName}}
        </div>
    </div>

    <!-- Prix/Charge/Durée -->
    <div class="icon-label" *ngIf="itemTemplate.data.price">
        <mat-icon fontSet="game-icon" fontIcon="game-icon-two-coins" class="ra-mat-button-icon-24"></mat-icon>
        <div>
            <ng-template [ngIf]="itemTemplate.data.price >= 1">
                {{itemTemplate.data.price | number}} P.O.
            </ng-template>

            <ng-template [ngIf]="itemTemplate.data.price < 1 && itemTemplate.data.price >= 0.1">
                {{itemTemplate.data.price * 10}} P.A.
            </ng-template>

            <ng-template [ngIf]="itemTemplate.data.price < 0.1">
                {{itemTemplate.data.price * 100}} P.C.
            </ng-template>
        </div>
    </div>

    <div *ngIf="itemTemplate.data.duration">
        <span>Durée:</span>
        {{itemTemplate.data.duration}}
    </div>

    <!-- Charge / Action -->

    <div *ngIf="itemTemplate.data.charge">
        <div>
            <span>Nombre d'utilisations:</span>
            {{itemTemplate.data.charge}}
        </div>
        <div *ngIf="itemTemplate.data?.actions?.length">
            Lors de l'utilisation:
            <div *ngFor="let action of itemTemplate.data.actions" style="margin-left: 20px">
                <nhbk-action *ngIf="!action.hidden" [action]="action"></nhbk-action>
            </div>
        </div>
    </div>


    <div class="icon-label" *ngIf="itemTemplate.data.weight">
        <mat-icon fontSet="game-icon" fontIcon="game-icon-weight" class="ra-mat-button-icon-24"></mat-icon>
        <div>
            <span>
                Poids:
            </span>
            <span *ngIf="itemTemplate.data.weight < 1">{{(itemTemplate.data.weight * 1000)}}g</span>
            <span *ngIf="itemTemplate.data.weight >= 1">{{(itemTemplate.data.weight)}}Kg</span>
        </div>
    </div>

    <!-- Degat -->
    <div class="icon-label" *ngIf="itemTemplate.data.bonusDamage || itemTemplate.data.damageDice">
        <mat-icon fontSet="ra" fontIcon="ra-broadsword" class="ra-mat-button-icon-24"></mat-icon>
        <div>
            <span *ngIf="itemTemplate.data.damageDice">{{itemTemplate.data.damageDice}}<span
                class="ra ra-perspective-dice-random"></span></span>
            <span *ngIf="itemTemplate.data.damageDice && itemTemplate.data.bonusDamage>0">+</span>
            <span *ngIf="itemTemplate.data.bonusDamage">{{itemTemplate.data.bonusDamage}}</span>
            <span *ngIf="itemTemplate.data.damageType">({{itemTemplate.data.damageType}})</span>
        </div>
    </div>

    <!-- Protection -->
    <div class="icon-label" *ngIf="itemTemplate.data.protection || itemTemplate.data.magicProtection || itemTemplate.data.protectionAgainstMagic">
        <mat-icon fontSet="ra" fontIcon="ra-shield" class="ra-mat-button-icon-24"></mat-icon>
        <div>
            <span>Protection: </span>
            <span *ngIf="itemTemplate.data.protection">{{itemTemplate.data.protection}}</span>
            <span *ngIf="itemTemplate.data.protection && itemTemplate.data.magicProtection">+</span>
            <span *ngIf="itemTemplate.data.magicProtection">{{itemTemplate.data.magicProtection}} (magique)</span>
            <span *ngIf="(itemTemplate.data.protection || itemTemplate.data.magicProtection) && itemTemplate.data.protectionAgainstMagic">/</span>
            <span *ngIf="itemTemplate.data.protectionAgainstMagic">{{itemTemplate.data.protectionAgainstMagic}}>
                <span *ngIf="itemTemplate.data.protectionAgainstType">(contre {{itemTemplate.data.protectionAgainstType}})</span>
                <span *ngIf="!itemTemplate.data.protectionAgainstType">(contre mag./myst.)</span>
            </span>
        </div>
    </div>

    <!-- Rupture -->
    <div class="icon-label" *ngIf="itemTemplate.data.rupture != undefined">
        <mat-icon fontSet="game-icon" fontIcon="game-icon-cracked-shield" class="ra-mat-button-icon-24"></mat-icon>
        <div>
            <div *ngIf="itemTemplate.data.rupture">
                Rupture:
                1 à {{itemTemplate.data.rupture}}
            </div>
            <div *ngIf="itemTemplate.data.rupture === 0">
                Rupture: Incassable
            </div>
        </div>
    </div>

    <!-- Modificateurs -->
    <div class="icon-label" *ngIf="itemTemplate.modifiers?.length">
        <mat-icon fontSet="game-icon" fontIcon="game-icon-skills" class="ra-mat-button-icon-24"></mat-icon>
        <div class="stats">
            <div *ngFor="let modifier of itemTemplate.modifiers">
                <span *ngIf="jobsName && modifier.job">{{jobsName[modifier.job]}}:</span>
                <span *ngIf="originsName && modifier.origin">{{originsName[modifier.origin]}}:</span>
                {{modifier | modifier}}
            </div>
        </div>
    </div>

    <!-- Compétences ajouté/annulé -->
    <ng-template ngFor let-skill [ngForOf]="itemTemplate.skills">
        <div>Donne la compétence "{{skill.name}}"</div>
    </ng-template>
    <ng-template ngFor let-skill [ngForOf]="itemTemplate.unskills">
        <div>Annule la compétence "{{skill.name}}"</div>
    </ng-template>
    <ng-template ngFor let-modifier [ngForOf]="itemTemplate.skillModifiers">
        <div>
            {{modifier.skill.name}} <span *ngIf="modifier.value > 0">+</span>{{modifier.value}}
        </div>
    </ng-template>


    <!-- Prérequis -->
    <ng-template ngFor let-requirement [ngForOf]="itemTemplate.requirements">
        <div>
            <span *ngIf="requirement.min">Min {{requirement.stat}}: {{requirement.min}}</span>
            <span *ngIf="requirement.max">Max {{requirement.stat}}: {{requirement.max}}</span>
        </div>
    </ng-template>

    <!-- Origine -->
    <div *ngIf="itemTemplate.data.origin">
        Origine: {{itemTemplate.data.origin}}
    </div>

    <!-- Gun -->
    <div class="icon-label" *ngIf="itemTemplate.data.gun">
        <mat-icon fontSet="game-icon" fontIcon="game-icon-revolver" class="ra-mat-button-icon-24"></mat-icon>
        <div>
            <h3 class="mat-h3">Arme à poudre</h3>
            <dl>
                <dt>Portée utile:</dt>
                <dd>{{itemTemplate.data.gun.range}}</dd>
                <dt>Dégâts:</dt>
                <dd>{{itemTemplate.data.gun.damages}}</dd>
                <dt>+Spécial:</dt>
                <dd>{{itemTemplate.data.gun.special}}</dd>
                <dt>Cadence de tir:</dt>
                <dd>{{itemTemplate.data.gun.rateOfFire}}</dd>
                <dt>Délai de rechargement:</dt>
                <dd>{{itemTemplate.data.gun.reloadDelay}}</dd>
                <dt>Épreuve de tir:</dt>
                <dd>{{itemTemplate.data.gun.shootTest}}</dd>
            </dl>
            <mat-divider></mat-divider>
            <h3 class="mat-h3">Munitions</h3>
            <dl>
                <dt *ngIf="itemTemplate.data.gun.fuelPerShot">
                    Combustion par coup:
                </dt>
                <dd *ngIf="itemTemplate.data.gun.fuelPerShot">
                    {{itemTemplate.data.gun.fuelPerShot}}
                </dd>
                <dt>Munitions par coup:</dt>
                <dd>{{itemTemplate.data.gun.ammunitionPerShot}}</dd>
            </dl>
            <mat-divider></mat-divider>
            <dl>
                <dt>Chances de fonctionnement:</dt>
                <dd>{{itemTemplate.data.gun.workLuck}}</dd>
            </dl>
        </div>
    </div>

    <!-- Indice de rareté -->
    <div *ngIf="itemTemplate.data.rarityIndicator">
        Indice de rareté: {{itemTemplate.data.rarityIndicator}}
    </div>

</mat-card>
